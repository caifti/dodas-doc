<!doctype html><html lang="en" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="lang:clipboard.copy" content="Copy to clipboard"><meta name="lang:clipboard.copied" content="Copied to clipboard"><meta name="lang:search.language" content="en"><meta name="lang:search.pipeline.stopwords" content="True"><meta name="lang:search.pipeline.trimmer" content="True"><meta name="lang:search.result.none" content="No matching documents"><meta name="lang:search.result.one" content="1 matching document"><meta name="lang:search.result.other" content="# matching documents"><meta name="lang:search.tokenizer" content="[\s\-]+"><link rel="shortcut icon" href="../assets/images/favicon.png"><meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.3.0"><title>Monitoring - Dynamic On Demand Analysis Service</title><link rel="stylesheet" href="../assets/stylesheets/application.4031d38b.css"><link rel="stylesheet" href="../assets/stylesheets/application-palette.224b79ff.css"><meta name="theme-color" content=""><script src="../assets/javascripts/modernizr.74668098.js"></script><link href="https://fonts.gstatic.com" rel="preconnect" crossorigin><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=swap"><style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel="stylesheet" href="../assets/fonts/material-icons.css"></head><body dir="ltr" data-md-color-primary="deep-blue" data-md-color-accent="orange"><svg class="md-svg"><defs></defs></svg> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"> <label class="md-overlay" data-md-component="overlay" for="__drawer"></label><a href="#monitoring" tabindex="1" class="md-skip">Skip to content </a><header class="md-header" data-md-component="header"><nav class="md-header-nav md-grid"><div class="md-flex"><div class="md-flex__cell md-flex__cell--shrink"><a href=".." title="Dynamic On Demand Analysis Service" class="md-header-nav__button md-logo"><i class="md-icon"></i></a></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label></div><div class="md-flex__cell md-flex__cell--stretch"><div class="md-flex__ellipsis md-header-nav__title" data-md-component="title"><span class="md-header-nav__topic">Dynamic On Demand Analysis Service</span><span class="md-header-nav__topic">Monitoring</span></div></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--search md-header-nav__button" for="__search"></label><div class="md-search" data-md-component="search" role="dialog"><label class="md-search__overlay" for="__search"></label><div class="md-search__inner" role="search"><form class="md-search__form" name="search"><input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active"> <label class="md-icon md-search__icon" for="__search"></label> <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">&#xE5CD;</button></form><div class="md-search__output"><div class="md-search__scrollwrap" data-md-scrollfix><div class="md-search-result" data-md-component="result"><div class="md-search-result__meta">Type to start searching</div><ol class="md-search-result__list"></ol></div></div></div></div></div></div></div></nav></header><div class="md-container"><main class="md-main"><div class="md-main__inner md-grid" data-md-component="container"><div class="md-sidebar md-sidebar--primary" data-md-component="navigation"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--primary" data-md-level="0"><label class="md-nav__title md-nav__title--site" for="__drawer"><a href=".." title="Dynamic On Demand Analysis Service" class="md-nav__button md-logo"><i class="md-icon"></i></a>Dynamic On Demand Analysis Service</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href=".." title="Dynamic On Demand Analysis Service: DODAS" class="md-nav__link">Dynamic On Demand Analysis Service: DODAS</a></li><li class="md-nav__item"><a href="../contacts/" title="Contact us" class="md-nav__link">Contact us</a></li><li class="md-nav__item"><a href="../dodas-how-it-is-made/" title="DODAS: How it is made" class="md-nav__link">DODAS: How it is made</a></li><li class="md-nav__item"><a href="../faq/" title="FAQ" class="md-nav__link">FAQ</a></li><li class="md-nav__item"><a href="../introduction/" title="Introduction" class="md-nav__link">Introduction</a></li><li class="md-nav__item"><a href="../known-issues/" title="Known Issues" class="md-nav__link">Known Issues</a></li><li class="md-nav__item md-nav__item--active"><input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc"><label class="md-nav__link md-nav__link--active" for="__toc">Monitoring</label><a href="./" title="Monitoring" class="md-nav__link md-nav__link--active">Monitoring</a><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="#monitoring-implementation" title="Monitoring implementation" class="md-nav__link">Monitoring implementation</a></li><li class="md-nav__item"><a href="#using-dodas-monitoring-backend" title="Using DODAS monitoring backend" class="md-nav__link">Using DODAS monitoring backend</a></li><li class="md-nav__item"><a href="#using-third-party-elasticsearch-endpoint" title="Using third party Elasticsearch endpoint" class="md-nav__link">Using third party Elasticsearch endpoint</a></li><li class="md-nav__item"><a href="#create-and-deploy-your-own-beat-or-sensor" title="Create and deploy your own Beat or sensor" class="md-nav__link">Create and deploy your own Beat or sensor</a></li></ul></nav></li><li class="md-nav__item"><a href="../the-enabling-facility/" title="The Enabling Facility" class="md-nav__link">The Enabling Facility</a></li><li class="md-nav__item"><a href="../troubleshooting/" title="Troubleshooting" class="md-nav__link">Troubleshooting</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10"><label class="md-nav__link" for="nav-10">Getting started</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-10">Getting started</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../getting-started/" title="Getting Started" class="md-nav__link">Getting Started</a></li><li class="md-nav__item"><a href="../getting-started/ams-recipe/" title="HTCondor AMS Recipe" class="md-nav__link">HTCondor AMS Recipe</a></li><li class="md-nav__item"><a href="../getting-started/cms-recipe/" title="HTCondor CMS Recipe" class="md-nav__link">HTCondor CMS Recipe</a></li><li class="md-nav__item"><a href="../getting-started/recipe-for-impatient-users/" title="Recipe for impatient users" class="md-nav__link">Recipe for impatient users</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11"><label class="md-nav__link" for="nav-11">Using dodas with external providers</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-11">Using dodas with external providers</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../using-dodas-with-external-providers/" title="Using DODAS with external providers" class="md-nav__link">Using DODAS with external providers</a></li><li class="md-nav__item"><a href="../using-dodas-with-external-providers/how-to-use-a-public-cloud/" title="How to use a public IaaS with DODAS-PaaS" class="md-nav__link">How to use a public IaaS with DODAS-PaaS</a></li><li class="md-nav__item"><a href="../using-dodas-with-external-providers/how-to-use-your-own-cloud/" title="How to use private IaaS with DODAS-PaaS" class="md-nav__link">How to use private IaaS with DODAS-PaaS</a></li></ul></nav></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component="toc"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="#monitoring-implementation" title="Monitoring implementation" class="md-nav__link">Monitoring implementation</a></li><li class="md-nav__item"><a href="#using-dodas-monitoring-backend" title="Using DODAS monitoring backend" class="md-nav__link">Using DODAS monitoring backend</a></li><li class="md-nav__item"><a href="#using-third-party-elasticsearch-endpoint" title="Using third party Elasticsearch endpoint" class="md-nav__link">Using third party Elasticsearch endpoint</a></li><li class="md-nav__item"><a href="#create-and-deploy-your-own-beat-or-sensor" title="Create and deploy your own Beat or sensor" class="md-nav__link">Create and deploy your own Beat or sensor</a></li></ul></nav></div></div></div><div class="md-content"><article class="md-content__inner md-typeset"><h1 id="monitoring">Monitoring</h1>
<p>This section provides the description of the knobs and handles DODAS provide to the end user in order to implement its own monitoring.</p>
<ul>
<li><a href="./#monitoring-implementation">Monitoring implementation</a></li>
<li><a href="./#using-dodas-monitoring-backend">Using DODAS monitoring backend</a></li>
<li><a href="./#using-third-party-elasticsearch-endpoint">Using third party Elasticsearch endpoint</a></li>
<li><a href="./#create-and-deploy-your-own-beat-or-sensor">Create and deploy your own Beat or sensor</a></li>
</ul>
<h2 id="monitoring-implementation">Monitoring implementation</h2>
<p>DODAS deployments can be monitored sending system and docker metrics collected by a <a href="https://www.elastic.co/guide/en/beats/metricbeat/current/index.html">metricbeat</a> to a desired <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html">Elasticsearch</a> backend for monitoring both the cluster VMs and the containers running on them. Once store in Elasticsearch the information are accessible from plain REST calls or visual dashboards can be produced with dedicated tools such as <a href="https://www.elastic.co/guide/en/kibana/current/index.html">Kibana</a> or <a href="http://docs.grafana.org/">Grafana</a>.</p>
<p>The <a href="../getting-started/cms-recipe/">CMS recipe</a> already includes the deployment of a metricbeat sensor on each Mesos slave configured as <a href="https://gist.githubusercontent.com/dciangot/69b61ff2bb1327b6485af88ac06c71ff/raw/">here</a>. Two modules are used among the variety available: <a href="https://www.elastic.co/guide/en/beats/metricbeat/current/metricbeat-module-system.html">system</a> and <a href="https://www.elastic.co/guide/en/beats/metricbeat/current/metricbeat-module-docker.html">docker</a>.</p>
<h2 id="using-dodas-monitoring-backend">Using DODAS monitoring backend</h2>
<p>It is possible to store metrics in a ready-to-use infrastructure composed by an Elasticsearch instance and an associated Grafana server where users can log in through DODAS IAM authentication.</p>
<p>If you are interested in using these resource please contact the support team at dodas-support&lt;at&gt;lists.infn.it asking for the authorization. You will receive the credentials needed for pushing information from metricbeat to the DODAS Elasticsearch. More over a dedicate Grafana project will be created as well with you as administrator.</p>
<h2 id="using-third-party-elasticsearch-endpoint">Using third party Elasticsearch endpoint</h2>
<p>To send metrics to your own server, you can simply change the following configuration parameters within the <a href="../getting-started/cms-recipe/">CMS recipe</a></p>
<pre><code class="text">monitordb_ip:
  type: string
  default: &quot;host:port&quot;

elasticsearch_secret:  
  type: string
  default: &quot;password&quot;
</code></pre>

<p>N.B. default user is `dodas`, this will be configurable on next versions</p>
<h2 id="create-and-deploy-your-own-beat-or-sensor">Create and deploy your own Beat or sensor</h2>
<p>One can create its own beat to send customized metrics to Elasticsearch following this <a href="https://www.elastic.co/guide/en/beats/devguide/current/new-beat.html">guide</a>. Once the beat is ready and compiled one can create a docker container with the beat binary inside to orchestrate the distribution inside the cluster as a Marathon app. </p>
<p>If you prefer python over the golang beat approach, just create your own daemon pushing json documents in elasticsearch <a href="https://elasticsearch-py.readthedocs.io/en/master/api.html#elasticsearch.Elasticsearch.create">one by one</a> or if you expect a big amount of docs each polling cycle push them in <a href="https://elasticsearch-py.readthedocs.io/en/master/api.html#elasticsearch.Elasticsearch.bulk">bulk</a>.</p></article></div></div></main><footer class="md-footer"><div class="md-footer-nav"><nav class="md-footer-nav__inner md-grid"><a href="../known-issues/" title="Known Issues" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev"><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-back md-footer-nav__button"></i></div><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">Previous</span>Known Issues</span></div></a><a href="../the-enabling-facility/" title="The Enabling Facility" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next"><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">Next</span>The Enabling Facility</span></div><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i></div></a></nav></div><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class="md-footer-copyright">powered by <a href="https://www.mkdocs.org">MkDocs</a> and <a href="https://squidfunk.github.io/mkdocs-material/">Material for MkDocs</a></div></div></div></footer></div><script src="../assets/javascripts/application.b260a35d.js"></script><script>app.initialize({version:"1.0.4",url:{base:".."}})</script></body></html>